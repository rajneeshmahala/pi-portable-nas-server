trigger:
- main

pool:
  vmImage: ubuntu-latest

steps:
- checkout: self
  clean: true

- task: JavaToolInstaller@0
  displayName: 'Install JDK 17'
  inputs:
    versionSpec: '17'
    jdkArchitectureOption: 'x64'
    jdkSourceOption: 'PreInstalled'

# Debug â€“ shows files clearly
- script: |
    echo "Repo root:"
    ls -la
    echo "android-app:"
    ls -la android-app
  displayName: 'Debug folder structure'

# Grant permission (NOW it will exist)
- script: |
    chmod +x android-app/gradlew
  displayName: 'Grant execute permission to gradlew'

# Build APK
- script: |
    android-app/gradlew clean assembleDebug
  displayName: 'Build Debug APK'

# Publish APK
- task: PublishPipelineArtifact@1
  inputs:
    targetPath: android-app/app/build/outputs/apk/debug
    artifact: DevX-APK