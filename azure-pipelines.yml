trigger:
- main

pool:
  vmImage: ubuntu-latest

steps:
- checkout: self

- task: JavaToolInstaller@0
  inputs:
    versionSpec: '17'
    jdkArchitectureOption: 'x64'
    jdkSourceOption: 'PreInstalled'

# Install supported Gradle (8.x, not 9.x)
- script: |
    wget https://services.gradle.org/distributions/gradle-8.5-bin.zip
    unzip gradle-8.5-bin.zip
    export PATH=$PWD/gradle-8.5/bin:$PATH
    gradle -v
  displayName: 'Install Gradle 8.5'

# Build using project path
- script: |
    gradle -p android-app clean assembleDebug
  displayName: 'Build Debug APK'

- task: PublishPipelineArtifact@1
  inputs:
    targetPath: android-app/app/build/outputs/apk/debug
    artifact: DevX-APK